(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[813],{8462:function(e,t,r){Promise.resolve().then(r.bind(r,3555)),Promise.resolve().then(r.bind(r,2591)),Promise.resolve().then(r.bind(r,6490)),Promise.resolve().then(r.bind(r,6422)),Promise.resolve().then(r.bind(r,6665))},6490:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a.Z},getGrid2UtilityClass:function(){return s},grid2Classes:function(){return i}});var a=r(2834),o=r(4535),n=r(7542);function s(e){return(0,n.ZP)("MuiGrid2",e)}let c=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12];var i=(0,o.Z)("MuiGrid2",["root","container","item","zeroMinWidth",...[0,1,2,3,4,5,6,7,8,9,10].map(e=>"spacing-xs-".concat(e)),...["column-reverse","column","row-reverse","row"].map(e=>"direction-xs-".concat(e)),...["nowrap","wrap-reverse","wrap"].map(e=>"wrap-xs-".concat(e)),...c.map(e=>"grid-xs-".concat(e)),...c.map(e=>"grid-sm-".concat(e)),...c.map(e=>"grid-md-".concat(e)),...c.map(e=>"grid-lg-".concat(e)),...c.map(e=>"grid-xl-".concat(e))])},6463:function(e,t,r){"use strict";var a=r(1169);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}}),r.o(a,"useServerInsertedHTML")&&r.d(t,{useServerInsertedHTML:function(){return a.useServerInsertedHTML}})},6422:function(e,t,r){"use strict";r.d(t,{AccountDetailsForm:function(){return x}});var a=r(7437),o=r(2265),n=r(5519),s=r(270),c=r(2879),i=r(4696),u=r(7318),l=r(8644),d=r(6065),h=r(866),g=r(2834),m=r(3719),f=r(3814),v=r(6463),p=r(5240);function x(){let[e,t]=(0,o.useState)(null),[r,x]=(0,o.useState)({id:"",firstName:"",lastName:"",email:"",avatar:"",jobTitle:"",country:"",city:"",timezone:"",status:""}),[y,Z]=(0,o.useState)(!0),[j,w]=(0,o.useState)(null),b=(0,v.useRouter)();(0,o.useEffect)(()=>{!async function(){let{data:e,error:r}=await f.U.getUser();if(r){Z(!1),b.push(p.H.errors.notFound);return}if(e&&"object"==typeof e){let r={id:e.id,firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||"",avatar:e.avatar||"",jobTitle:e.jobTitle||"",country:e.country||"",city:e.city||"",timezone:e.timezone||"",status:e.status||""};t(r),x(r)}else t(null),b.push(p.H.errors.notFound);Z(!1)}()},[]);let k=e=>{x({...r,[e.target.name]:e.target.value})};return y?(0,a.jsx)(m.Z,{children:"Loading..."}):j?(0,a.jsxs)(m.Z,{color:"error",children:["Error: ",j]}):e?(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),console.log(r)},children:(0,a.jsxs)(s.Z,{children:[(0,a.jsx)(i.Z,{children:(0,a.jsxs)(g.Z,{container:!0,spacing:3,children:[(0,a.jsx)(g.Z,{md:5,xs:0,children:(0,a.jsxs)(l.Z,{fullWidth:!0,required:!0,children:[(0,a.jsx)(d.Z,{children:"Имя"}),(0,a.jsx)(h.Z,{name:"firstName",label:"Имя",value:r.firstName,onChange:k})]})}),(0,a.jsx)(g.Z,{md:5,xs:0,children:(0,a.jsxs)(l.Z,{fullWidth:!0,required:!0,children:[(0,a.jsx)(d.Z,{children:"Фамилия"}),(0,a.jsx)(h.Z,{name:"lastName",label:"Фамилия",value:r.lastName,onChange:k})]})}),(0,a.jsx)(g.Z,{md:5,xs:10,children:(0,a.jsxs)(l.Z,{fullWidth:!0,required:!0,children:[(0,a.jsx)(d.Z,{children:"Почта"}),(0,a.jsx)(h.Z,{name:"email",label:"Почта",value:r.email,onChange:k})]})}),(0,a.jsx)(g.Z,{md:5,xs:10,children:(0,a.jsxs)(l.Z,{fullWidth:!0,children:[(0,a.jsx)(d.Z,{children:"Город"}),(0,a.jsx)(h.Z,{name:"city",value:r.city,onChange:k})]})}),(0,a.jsx)(g.Z,{md:5,xs:10,children:(0,a.jsxs)(l.Z,{fullWidth:!0,children:[(0,a.jsx)(d.Z,{children:"Страна"}),(0,a.jsx)(h.Z,{name:"country",value:r.country,onChange:k})]})})]})}),(0,a.jsx)(u.Z,{}),(0,a.jsx)(c.Z,{children:(0,a.jsx)(n.Z,{variant:"contained",type:"submit",sx:{backgroundColor:"#1b3a69","&:hover":{backgroundColor:"#0f1e3c"}},children:"Сохранить"})})]})}):(0,a.jsx)(m.Z,{children:"No user data found"})}},6665:function(e,t,r){"use strict";r.d(t,{AccountInfo:function(){return v}});var a=r(7437),o=r(2265),n=r(5349),s=r(5519),c=r(270),i=r(2879),u=r(4696),l=r(7318),d=r(8929),h=r(3719),g=r(3814),m=r(6463),f=r(5240);function v(){let[e,t]=(0,o.useState)(null),[r,v]=(0,o.useState)(!0),[p,x]=(0,o.useState)(null),[y,Z]=(0,o.useState)(null),j=(0,m.useRouter)();(0,o.useEffect)(()=>{!async function(){v(!0);let{data:e,error:r}=await g.U.getUser();if(r){Z("Failed to fetch user data"),v(!1),j.push(f.H.errors.notFound);return}e?t(e):(t(null),Z("User data is invalid"),j.push(f.H.errors.notFound)),v(!1)}()},[j]);let w=e=>{e.target.files&&e.target.files.length>0&&x(e.target.files[0])},b=async()=>{if(!p){Z("No file selected");return}try{let e=await g.U.uploadAvatar(p);if(e.error)Z(e.error);else{Z(null);let{data:e}=await g.U.getUser();e?t(e):Z("Failed to refresh user data after upload")}}catch(e){Z("An unexpected error occurred")}};return r?(0,a.jsx)(h.Z,{children:"Loading..."}):(0,a.jsxs)(c.Z,{children:[(0,a.jsx)(u.Z,{children:(0,a.jsxs)(d.Z,{spacing:2,sx:{alignItems:"center"},children:[(0,a.jsx)("div",{children:(0,a.jsx)(n.Z,{src:null==e?void 0:e.avatar,sx:{height:"80px",width:"80px"}})}),(0,a.jsxs)(d.Z,{spacing:1,sx:{textAlign:"center"},children:[(0,a.jsxs)(h.Z,{variant:"h5",children:[null==e?void 0:e.firstName," ",null==e?void 0:e.lastName]}),(0,a.jsxs)(h.Z,{color:"text.secondary",variant:"body2",children:[null==e?void 0:e.city," ",null==e?void 0:e.country]}),(0,a.jsx)(h.Z,{color:"text.secondary",variant:"body2",children:null==e?void 0:e.timezone})]})]})}),(0,a.jsx)(l.Z,{}),(0,a.jsxs)(i.Z,{children:[(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{w(e)},style:{display:"none"},id:"file-input"}),(0,a.jsx)("label",{htmlFor:"file-input",children:(0,a.jsx)(s.Z,{fullWidth:!0,variant:"contained",component:"span",onClick:async()=>{var e;let t=document.getElementById("file-input");t&&(null===(e=t.files)||void 0===e?void 0:e.length)?await b():Z("No file selected")},sx:{backgroundColor:"#1b3a69","&:hover":{backgroundColor:"#0f1e3c"}},children:"Загрузить Аватар"})}),y&&(0,a.jsx)(h.Z,{color:"error",variant:"body2",children:y})]})]})}},3814:function(e,t,r){"use strict";r.d(t,{U:function(){return c}});var a=r(8472);let o=a.Z.create({baseURL:"http://37.194.168.90:2100"}),n=a.Z.create({baseURL:"http://37.194.168.90:2000"});o.interceptors.request.use(e=>(console.log("Starting Request: ",e),e));class s{async signUp(e){let{email:t,password:r,firstName:n,lastName:s}=e;try{return await o.post("auth/signup",{email:t,password:r,firstName:n,lastName:s,headers:{Authorization:"".concat(localStorage.getItem("custom-auth-token"))}}),{}}catch(e){if(a.Z.isAxiosError(e)){var c;return{error:(null===(c=e.response)||void 0===c?void 0:c.data)||"An error occurred"}}return{error:"An unknown error occurred"}}}async signInWithOAuth(e){return{error:"Social authentication not implemented"}}async signInWithPassword(e){let{email:t,password:r}=e;try{let e=await o.post("auth/signin",{email:t,password:r,headers:{Authorization:"".concat(localStorage.getItem("custom-auth-token"))}}),{token:a}=e.data,{token_name:n}=e.data;return console.log(n,a),a&&n&&localStorage.setItem(n,a),{}}catch(e){if(a.Z.isAxiosError(e)){var n;return{error:(null===(n=e.response)||void 0===n?void 0:n.data)||"An error occurred"}}return{error:"An unknown error occurred"}}}async resetPassword(e){return{error:"Password reset not implemented"}}async updatePassword(e){return{error:"Update reset not implemented"}}async getUser(){try{let e=localStorage.getItem("custom-auth-token");console.log("token = "+e);let t=await o.get("account/getinfo",{headers:{Authorization:"".concat(e)}});if(!t.data)return{data:null};return{data:t.data}}catch(e){return{data:null}}}async createEvent(e){try{return{data:(await o.post("events/create",e,{headers:{Authorization:"".concat(localStorage.getItem("custom-auth-token"))}})).data}}catch(e){return console.error("Error creating event:",e),{error:"Failed to create event"}}}async saveTags(e){console.log(e);try{return{data:(await o.post("account/tags",e,{headers:{Authorization:"".concat(localStorage.getItem("custom-auth-token"))}})).data}}catch(e){return console.error("Error creating event:",e),{error:"Failed to create event"}}}async getEventsCount(){try{let e=localStorage.getItem("custom-auth-token");console.log("token = "+e);let t=await o.get("events/count",{headers:{Authorization:"".concat(e)}});if(!t.data)return{data:null};return{data:t.data}}catch(e){return{data:null}}}async getMyEvent(){try{return console.log(localStorage.getItem("custom-auth-token")),{data:(await o.post("events/getall",null,{headers:{Authorization:"".concat(localStorage.getItem("custom-auth-token"))}})).data}}catch(e){return console.error("Error fetching event:",e),{error:"Failed to fetch event"}}}async deleteEvent(e){try{return{data:(await o.post("events/delete",e,{headers:{Authorization:"".concat(localStorage.getItem("custom-auth-token"))}})).data}}catch(e){return console.error("Error deleting events:",e),{error:"Failed to delete events"}}}async uploadAvatar(e){let t=new FormData;t.append("file",e),console.log("formData");try{let[e,r]=(await o.post("account/savefile",t,{headers:{Authorization:"".concat(localStorage.getItem("custom-auth-token"))}})).data;return{url:r}}catch(e){return{error:"Error uploading avatar"}}}async getCalendar(){try{return{data:(await o.get("calendar/get",{headers:{Authorization:"".concat(localStorage.getItem("custom-auth-token"))}})).data}}catch(e){return{error:"Error signing out"}}}async signOut(){try{return await o.get("account/logout",{headers:{Authorization:"".concat(localStorage.getItem("custom-auth-token"))}}),document.cookie="custom-auth-token=; path=/; max-age=0;",{}}catch(e){return{error:"Error signing out"}}}async callback(){try{console.log("callback");let e=new URLSearchParams(window.location.search).get("code");return await n.get("/callback",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("custom-auth-token"))},params:{code:e}}),{}}catch(e){return console.error("Error occurred:",e),{error:"Error during the start of monitoring"}}}async hhStatus(){try{return(await n.get("monitoring/status",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("custom-auth-token"))}})).data}catch(e){return console.error("Error occurred:",e),!1}}async hhStart(){try{let e=await n.get("monitoring/start",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("custom-auth-token"))}});if(202===e.status){let t=e.data;t&&(window.location.href=t)}return{error:e.data||"No data from server"}}catch(e){return console.error("Error occurred:",e),{error:"Error during the start of monitoring"}}}async hhStop(){try{return await n.get("monitoring/stop",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("custom-auth-token"))}}),document.cookie="custom-auth-token=; path=/; max-age=0;",{}}catch(e){return{error:"Error signing out"}}}async signUpToken(e){try{let t=await o.post("auth/confirm",{check_token:e},{headers:{Authorization:"".concat(localStorage.getItem("custom-auth-token"))}}),{token:r}=t.data,{token_name:a}=t.data;return console.log(a,r),r&&a&&localStorage.setItem(a,r),{}}catch(e){if(a.Z.isAxiosError(e)){var t;return{error:(null===(t=e.response)||void 0===t?void 0:t.data)||"An error occurred"}}return{error:"An unknown error occurred"}}}async subscribe(e){try{console.log("eventId = "+e);let t=await o.post("events/subscribe",{eventId:e},{headers:{Authorization:"".concat(localStorage.getItem("custom-auth-token"))}}),{token:r}=t.data,{token_name:a}=t.data;return console.log(a,r),r&&a&&localStorage.setItem(a,r),{}}catch(e){if(a.Z.isAxiosError(e)){var t;return{error:(null===(t=e.response)||void 0===t?void 0:t.data)||"An error occurred"}}return{error:"An unknown error occurred"}}}}let c=new s},5240:function(e,t,r){"use strict";r.d(t,{H:function(){return a}});let a={home:"/",auth:{signIn:"/auth/sign-in",signUp:"/auth/sign-up",resetPassword:"/auth/reset-password",confirm:"/auth/confirm",hhcallback:"/auth/callback",subscribe:"/auth/subscribe"},dashboard:{overview:"/dashboard",account:"/dashboard/account",customers:"/dashboard/customers",settings:"/dashboard/settings"},errors:{notFound:"/errors/not-found"}}}},function(e){e.O(0,[342,919,472,125,907,296,564,545,971,23,744],function(){return e(e.s=8462)}),_N_E=e.O()}]);